{
  "prompts": [
    { 
      "name": "gardener_scout_rule_refactorer", 
      "title": "Gardener · Scout-Rule Refactorer", 
      "description": "Behavior-preserving micro-refactors in tiny reversible steps; always-green CI; XP/Lean/TDD aligned.",
      "arguments": [
        { "name": "repo_or_path_glob", "description": "Target repository or path glob pattern", "required": true },
        { "name": "timebox_minutes", "description": "Time limit for the refactoring session in minutes", "required": true },
        { "name": "max_diff_lines", "description": "Maximum number of changed lines allowed", "required": true },
        { "name": "max_files", "description": "Maximum number of files to touch", "required": true },
        { "name": "days", "description": "Number of days to check for heavy churn", "required": true }
      ]
    },
    { 
      "name": "gardener_naming_api_clarity", 
      "title": "Gardener · Naming & API Clarity", 
      "description": "DDD-aligned naming, value objects, and intent-revealing APIs without behavior change.",
      "arguments": [
        { "name": "module_or_path", "description": "Target module or path to refactor", "required": true },
        { "name": "max_renames", "description": "Maximum number of automated renames allowed", "required": true }
      ]
    },
    { 
      "name": "gardener_deadcode_dup_pruner", 
      "title": "Gardener · Dead Code & Duplication Pruner", 
      "description": "Evidence-driven deletion and tiny DRY merges with strict safety gates.",
      "arguments": [
        { "name": "paths", "description": "Target paths to analyze for dead code", "required": true },
        { "name": "coverage_cmd", "description": "Command to check coverage/runtime", "required": true },
        { "name": "stale_days", "description": "Git inactivity threshold in days", "required": true },
        { "name": "max_deleted_lines", "description": "Maximum number of lines to delete", "required": true }
      ]
    },
    { 
      "name": "gardener_complexity_reducer", 
      "title": "Gardener · Complexity Reducer", 
      "description": "Lower cyclomatic/cognitive complexity via small, behavior-preserving extractions.",
      "arguments": [
        { "name": "report_path_or_cmd", "description": "Path to complexity report or command to generate it", "required": true },
        { "name": "max_diff_lines", "description": "Maximum number of changed lines allowed", "required": true },
        { "name": "max_new_classes", "description": "Maximum number of new strategy/command objects", "required": true }
      ]
    },
    { 
      "name": "gardener_test_suite_gardener", 
      "title": "Gardener · Test Gardener", 
      "description": "Strengthen tests first; kill flakiness/slow tests; introduce seams safely.",
      "arguments": [
        { "name": "test_paths", "description": "Target test paths to improve", "required": true },
        { "name": "runtime_pct", "description": "Target percentage reduction in runtime", "required": true }
      ]
    },
    { 
      "name": "gardener_dependency_gardener", 
      "title": "Gardener · Dependency Gardener", 
      "description": "Safe micro-upgrades (patch/minor), one logical upgrade per PR, full CI + smoke check.",
      "arguments": [
        { "name": "manifest_path_or_list", "description": "Path to package manifest or list of dependencies", "required": true },
        { "name": "smoke_cmd", "description": "Command to run smoke tests", "required": true }
      ]
    },
    { 
      "name": "gardener_parallel_change_preparer", 
      "title": "Gardener · Parallel-Change Preparer", 
      "description": "Introduce a reversible seam with a toggle/flag; keep old and new paths working.",
      "arguments": [
        { "name": "target_component", "description": "Component to prepare for parallel change", "required": true },
        { "name": "new_iface_name", "description": "Name for the new interface/adapter", "required": true },
        { "name": "flag_name", "description": "Name for the feature flag", "required": true },
        { "name": "max_diff_lines", "description": "Maximum number of changed lines allowed", "required": true }
      ]
    },
    { 
      "name": "gardener_boundary_clarifier", 
      "title": "Gardener · Boundary Clarifier", 
      "description": "Tighten domain/infra boundaries (ports/adapters) in tiny steps.",
      "arguments": [
        { "name": "domain_module", "description": "Target domain module to clarify boundaries", "required": true }
      ]
    },
    { 
      "name": "gardener_invariant_guardrails", 
      "title": "Gardener · Invariant Guardrails", 
      "description": "Add value objects/validations and fast-fail assertions for key invariants.",
      "arguments": [
        { "name": "aggregate_or_entity", "description": "Target aggregate or entity to add guardrails", "required": true }
      ]
    },
    { 
      "name": "gardener_fitness_functions", 
      "title": "Gardener · Fitness-Function Writer", 
      "description": "Encode small architecture rules as tests/static checks; wire into CI.",
      "arguments": [
        { "name": "tooling_choice", "description": "Tooling to use for implementing fitness functions", "required": true },
        { "name": "tooling_path", "description": "Path to place the fitness function tooling", "required": true }
      ]
    }
  ],
  "definitions": {
    "gardener_scout_rule_refactorer": { "name": "gardener_scout_rule_refactorer", "title": "Gardener · Scout-Rule Refactorer", "description": "Behavior-preserving micro-refactors; tiny reversible steps; always-green CI; XP/Lean/TDD aligned.", "messages": [ { "role": "user", "content": { "type": "text", "text": "ROLE: Autonomous Software Gardener.\nWORKING STYLE: XP + Lean, TDD first, trunk-based development, walking skeleton, continuous delivery, DDD naming, YAGNI. Keep mainline green.\nSCOPE: {{repo_or_path_glob}}\nTIMEBOX: {{timebox_minutes}} minutes\nLIMITS: ≤ {{max_diff_lines}} changed lines total; ≤ {{max_files}} files touched; avoid files with heavy churn in last {{days}} days.\nTASK:\n1) Identify 1–3 low-risk, high-signal refactors (rename for clarity, extract small pure functions, remove duplication, inline trivial indirections).\n2) Add/strengthen micro-tests BEFORE refactor where coverage is weak. Keep behavior constant.\n3) Run: lint, type-check, unit tests, fast integration.\n4) Prepare ONE PR.\nCONSTRAINTS:\n- No public API changes. No cross-module moves. No formatting-only PRs.\n- Keep commits atomic; intent-revealing commit messages.\nPR TEMPLATE:\nTitle: Gardening: <short noun phrase>\nBody: Problem & rationale; Summary of refactors; Test evidence (commands + counts); Risk assessment (why behavior unchanged); Rollback plan (git revert hash).\nChecklist: [ ] Tests green  [ ] No API changes  [ ] ≤ {{max_diff_lines}} LOC  [ ] Changelog/ADR updated if needed\n" } } ] },
    "gardener_naming_api_clarity": { "name": "gardener_naming_api_clarity", "title": "Gardener · Naming & API Clarity", "description": "DDD-aligned naming, value objects, and intent-revealing APIs without behavior change.", "messages": [ { "role": "user", "content": { "type": "text", "text": "ROLE: XP/Lean Software Gardener focused on semantic clarity.\nTARGET: {{module_or_path}}\nLIMITS: Max automated renames ≤ {{max_renames}}. Behavior must not change.\nTASK:\n1) Detect 1–2 naming/API clarity issues (ambiguous method names, anemic value objects, mixed domain/infra terms).\n2) Write characterization tests if missing, then refactor names or extract value objects reflecting the ubiquitous language.\n3) Update references via IDE-safe/AST-safe refactors.\n4) Run unit → component → smoke tests.\nOUTPUT: Single PR including short domain glossary snippet, before/after examples, and test evidence. Avoid breaking external consumers.\n" } } ] },
    "gardener_deadcode_dup_pruner": { "name": "gardener_deadcode_dup_pruner", "title": "Gardener · Dead Code & Duplication Pruner", "description": "Evidence-driven deletion and tiny DRY merges with strict safety gates.", "messages": [ { "role": "user", "content": { "type": "text", "text": "ROLE: Software Gardener prioritizing simplicity and basal cost reduction.\nTARGET PATHS: {{paths}}\nEVIDENCE SOURCES: Coverage/Runtime via {{coverage_cmd}}; Git inactivity threshold {{stale_days}} days; static search (unreferenced symbols/branches).\nLIMITS: Max deletions ≤ {{max_deleted_lines}} lines; keep public API intact.\nTASK:\n1) Prove unreachability for dead code candidates (search/build/coverage evidence).\n2) Add/boost tests at remaining call sites to preserve behavior.\n3) Delete dead code or merge tiny duplications (≤ 25 lines each) via extract method.\nPR BODY must include an Evidence Table (symbol → refs → coverage → decision), risks, and rollback.\n" } } ] },
    "gardener_complexity_reducer": { "name": "gardener_complexity_reducer", "title": "Gardener · Complexity Reducer", "description": "Lower cyclomatic/cognitive complexity via small extractions; keep behavior constant.", "messages": [ { "role": "user", "content": { "type": "text", "text": "ROLE: Complexity Reducer using tiny, reversible steps.\nHOTSPOTS: Ranked by {{report_path_or_cmd}}\nLIMITS: ≤ {{max_diff_lines}} changed lines; ≤ {{max_new_classes}} small strategy/command objects.\nTASK:\n1) Select top 1–2 hotspots.\n2) Add/strengthen narrow tests around current behavior.\n3) Extract pure helpers; isolate side effects behind thin interfaces; use guard clauses to flatten nesting.\n4) Provide before/after complexity metrics.\nCONSTRAINTS: No new external dependencies; no public API change.\n" } } ] },
    "gardener_test_suite_gardener": { "name": "gardener_test_suite_gardener", "title": "Gardener · Test Gardener", "description": "Strengthen tests first; eliminate flakiness and reduce runtime without losing signal.", "messages": [ { "role": "user", "content": { "type": "text", "text": "ROLE: Test Gardener.\nTARGET: {{test_paths}}\nGOAL: Reduce total test runtime by ≥ {{runtime_pct}}% and remove flaky patterns.\nTASK:\n1) Identify 1–2 brittle/slow tests (sleep/polling, network/file I/O, shared mutable state).\n2) Introduce seams (ports/adapters) to stub external systems; prefer table-driven or property-based tests for pure logic.\n3) Replace broad E2E checks with focused component tests where appropriate; add missing edge-case tests; remove redundant overlaps.\nOUTPUT: PR with runtime before/after, flakiness notes, and evidence that coverage/signal did not regress.\n" } } ] },
    "gardener_dependency_gardener": { "name": "gardener_dependency_gardener", "title": "Gardener · Dependency Gardener", "description": "Safe micro-upgrades (patch/minor), one logical upgrade per PR, full CI + smoke check and explicit rollback.", "messages": [ { "role": "user", "content": { "type": "text", "text": "ROLE: Dependency Gardener.\nTARGET: {{manifest_path_or_list}}\nSMOKE: {{smoke_cmd}}\nTASK:\n1) Propose 1–2 patch/minor upgrades with the lowest blast radius.\n2) Refresh lockfile; run full tests and smoke deployment/runtime.\n3) If breaking changes appear, either adapt with minimal edits or skip; avoid majors unless explicitly allowed.\nOUTPUT: One PR per logical upgrade with changelog snippets, compatibility notes, and rollback instructions.\n" } } ] },
    "gardener_parallel_change_preparer": { "name": "gardener_parallel_change_preparer", "title": "Gardener · Parallel-Change Preparer", "description": "Introduce a reversible seam (parallel change) with a default-OFF flag; old and new paths must both work.", "messages": [ { "role": "user", "content": { "type": "text", "text": "ROLE: Parallel-Change Preparer.\nTARGET: {{target_component}}\nSEAM: New interface/adapter {{new_iface_name}}; flag {{flag_name}} (default OFF).\nLIMITS: ≤ {{max_diff_lines}} changed lines; add characterization tests for old path and equivalent tests for new path behind the flag.\nTASK:\n1) Introduce the new interface/adapter that mirrors behavior.\n2) Implement toggled path; keep both paths green in CI.\n3) Add lightweight metrics/logs to compare behavior when toggled in staging.\nOUTPUT: PR explaining the parallel change plan and next steps; ensure no user-visible behavior change.\n" } } ] },
    "gardener_boundary_clarifier": { "name": "gardener_boundary_clarifier", "title": "Gardener · Boundary Clarifier", "description": "Tighten domain/infra boundaries using ports/adapters with minimal code movement.", "messages": [ { "role": "user", "content": { "type": "text", "text": "ROLE: Boundary Clarifier (DDD).\nTARGET DOMAIN MODULE: {{domain_module}}\nTASK:\n1) Identify a direct infra call inside domain logic.\n2) Wrap it behind a port interface; move infra details to an adapter.\n3) Add tests at the port boundary; stub the adapter in domain tests.\nCONSTRAINTS: No schema/API changes. One boundary at a time. Max new types: 1 interface + 1 adapter.\nOUTPUT: PR with mini-ADR: context, decision, consequences.\n" } } ] },
    "gardener_invariant_guardrails": { "name": "gardener_invariant_guardrails", "title": "Gardener · Invariant Guardrails", "description": "Add value objects/validations and fast-fail assertions/logs to defend key domain invariants.", "messages": [ { "role": "user", "content": { "type": "text", "text": "ROLE: Invariant Guardrails.\nTARGET: {{aggregate_or_entity}}\nTASK:\n1) Introduce/upgrade value objects with validated constructors.\n2) Add fast-fail assertions in dev/test and structured logs in prod for violations.\n3) Extend tests for invalid inputs and boundary conditions.\nCONSTRAINTS: No behavior changes for valid inputs. Logs rate-limited and structured.\nOUTPUT: PR documenting the invariant and how it's enforced.\n" } } ] },
    "gardener_fitness_functions": { "name": "gardener_fitness_functions", "title": "Gardener · Fitness-Function Writer", "description": "Codify small architectural rules as fast checks/tests and wire them into CI.", "messages": [ { "role": "user", "content": { "type": "text", "text": "ROLE: Fitness-Function Writer.\nTOOLING: {{tooling_choice}}\nLOCATION: {{tooling_path}}\nTASK:\n1) Add 1–2 narrowly-scoped rules (examples: 'domain cannot import infra', 'no network calls in unit tests', 'max function length 60').\n2) Implement with the chosen tooling and integrate into CI.\n3) Provide guided suppressions for legacy files with TODO expiry dates.\nOUTPUT: PR with rule descriptions, rationale, and remediation guidance; include failing-example reproduction and how to fix.\n" } } ] }
  }
}
